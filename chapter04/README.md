# Chapter 04. 클래스와 인터페이스

추상화의 기본 단위인 클래스와 인터페이스는 자바 언의 심장과도 같다. 
클래스와 인터페이스를 쓰기 편하고, 견고하며, 유연하게 만드는 방법

## 아이템 15. 클래스와 멤버의 접근 권한을 최소화하라

프로그램의 요소와 접근성은 가능한 한 최소한으로 하라. 
꼭 필요한 것만 골라 최소한의 public API 를 설계하자. 
그 외에는 클래스, 인터페이스, 멤버가 의도치않게 API로 공개되는 일이 없도록 해야한다. 

잘 설계된 컴포넌트는 클래스 내부 데이터와 내부 구현 정보를 외부 컴포넌트로부터 얼마나 잘 숨겼느냐다. 
잘 설계된 컴포넌트는 모든 내부 구현을 완벽히 숨겨, 구현과 API 를 깔끔히 분리한다. 

### 캡슐화의 장점
- 시스템 개발 속도를 높인다. 여러 컴포넌트를 병렬로 개발 가능
- 시스템 관리 비용을 낮춘다. 각 컴포넌트를 더 빨리 파악하여 디버깅할 수 있고, 다른 컴포넌트로 교체하는 부담도 적기 때문이다. 
- 성능 최적화에 도움을 준다. 다른 컴포넌트에 영향을 주지 않고 해당 컴포넌트만 최적화 가능
- 소프트웨어 재사용성을 높인다. 
- 큰 시스템을 제작하는 난이도를 낮춘다. 

### 접근제어자
자바는 접근제한자를 활용해서 정보 은닉을 달성할 수 있다. 
- `private` : 멤버를 선언한 톱레벨 클래스에서만 접근할 수 있다. 
- `package-private`: 멤버가 소속된 패키지 안의 모든 클래스에서 접근할 수 있다. 접근제한자를 명시하지 않았을 때 적용되는 패키지 접근 수준이다. 
- `protected`: package-private의 접근 범위를 포함하며, 이 멤버를 선언한 클래스의 하위 클래스에서도 접근할 수 있다. [[JLS, 6.6.2](https://docs.oracle.com/javase/specs/jls/se8/html/jls-6.html#jls-6.6.2)]
- `public`: 모든 곳에서 접근할 수 있다. 

### 원칙
#### 모든 클래스와 멤버의 접근성을 가능한 한 좁혀야 한다. 
- 한 클래스에서만 사용하는 클래스나 인터페이스는 이를 사용하는 클래스 안에 private static 으로 중첩시킬 수 있다. 
- public 일 필요가 없는 클래스의 접근 수준을 package-private 톱레벨 클래스로 좁히는 것이 중요하다. 

### 주의사항
- 상위 클래스의 메서드를 재정의할 때는 그 접근 수준을 상위클래스에서보다 좁게 설정할 수 없다[[JLS, 8.4.9.3](https://docs.oracle.com/javase/specs/jls/se8/html/jls-8.html#jls-8.4.8.3)]
  - 상위 클래스의 인스턴스는 하위 클래스의 인스턴스로 대체해 사용할 수 있어야 한다는 규칙(리스코프 치환 원칙)을 지키기 위해 필요하다
- 코드를 테스트하려는 목적으로 접근범위를 넓힐 수도 있다. private 멤버를 package-private 까지 풀어주는 것은 허용할 수 있지만, 그 이상은 안 된다. 
- public 클래스의 인스턴스 필드는 되도록 public 이 아니어야 한다. 
- public 가변 필드를 갖는 클래스는 일반적으로 스레드 안전하지 않다. 
- 클래스에서 public static final 배열 필드를 두거나 이 필드를 반환하는 접근자 메서드를 제공해서는 안 된다.
  - public 배열을 private로 만들고, public 불변 리스트를 추가하거나,
  - 배열을 private로 만들고 그 복사본을 반환하는 pulbic 메서드를 추가함으로써 해결할 수 있다. 
  
### 자바9에 추가된 내용
- 자바 9에서는 모듈 시스템이라는 개념이 도입되면서 두 가지 암묵적 접근 수준이 추가되었다. 
  - 모듈은 자신이 속하는 패키지 중 공개(export) 할 것들을 (관례상 module-info.java 파일에) 선언한다. protected 혹은 public 멤버라도 해당 패키지를 공개하지 않았다면 모듈 외부에서는 접근할 수 없다. 
  - 숨겨진 패키지 안에 있는 public 클래스의 public, protected 멤버에 암묵적 접근 수준이 적용된다. 각각 public, protected 수준과 같으나, 그 효과가 모듈 내부로 한정된다. 
- 모듈 시스템을 활용하면 클래스를 외부에 공개하지 않으면서도 같은 모듈을 이루는 패키지 사이에서는 자유롭게 공유할 수 있다. 
- 주의해야 할 점
  - 모듈의 jar 파일을 자신의 모듈 경로가 아닌 애플리케이션의 클래스패스(classpath)에 두면 그 모듈 안의 모든 패키지는 마치 모듈이 없는 것 처럼 행동한다..
  - 모듈의 장점을 누리려면 해야할 일이 많다. 
- 꼭 필요한 경우가 아니라면 당분간은 사용하지 않는 게 좋을 것 같다. 

